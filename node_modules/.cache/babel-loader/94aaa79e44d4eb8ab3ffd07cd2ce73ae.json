{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _token = require('./util/token');\n\nvar _oauth = require('./oauth2');\n\nvar _oauth2 = _interopRequireDefault(_oauth);\n\nvar _actions = require('./actions');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    'default': obj\n  };\n}\n\nvar authMiddleware = function authMiddleware(store) {\n  return function (next) {\n    return function (action) {\n      switch (action.type) {\n        case _actions.LOGIN_REQUEST:\n          return (0, _oauth2['default'])(action.config).then(function (_ref) {\n            var token = _ref.token;\n            var expiresAt = _ref.expiresAt;\n            return store.dispatch((0, _actions.loginSuccess)(token, expiresAt));\n          }, function (error) {\n            return store.dispatch((0, _actions.loginFailure)(error));\n          });\n\n        case _actions.LOGIN_SUCCESS:\n          (0, _token.setToken)(action.token, action.expiresAt);\n          break;\n\n        case _actions.LOGIN_FAILURE:\n        case _actions.LOGOUT:\n          (0, _token.removeToken)();\n          break;\n      }\n\n      return next(action);\n    };\n  };\n};\n\nexports['default'] = authMiddleware;","map":null,"metadata":{},"sourceType":"script"}